version: 1
backend:
  phases:
    build:
      commands:
        - pip install --upgrade pip
        - pip install awscli aws-sam-cli
        - (cd backend && sam build && sam deploy --no-confirm-changeset --no-fail-on-empty-changeset --stack-name programming-learning-app-api --resolve-s3 --region ap-northeast-1 --capabilities CAPABILITY_IAM)
frontend:
  phases:
    preBuild:
      commands:
        - cd frontend && npm ci
    build:
      commands:
        - cd frontend && npm run build
  artifacts:
    baseDirectory: frontend/out
    files:
      - "**/*"
  cache:
    paths:
      - frontend/node_modules/**/*
      - frontend/.next/cache/**/*
